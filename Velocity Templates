## Email.vm is a Velocity macro file that serves as a template for the text
## sent for e-mail notifications.
## To change the text sent, edit the text below.
## The following fields are defined by default.
## The notification URL is automatically established by the ArcSight Web server
## host.
## The event URL links to the relevant event as viewed in ArcSight Web.
## Custom Email Template
##
#if($introspector.getDisplayValue($event, "flexString1") == "ex1")
#parse ("test/malware.vm")
#elseif ($introspector.getDisplayValue($event, "flexString1") == "ex2")
#parse ("test/unix.vm")
#elseif ($introspector.getDisplayValue($event, "flexString1") == "ex3")
#parse ("test/win.vm")
#else
#parse ("test/fail.vm")
#end

=================================================
ex1.vm
-------------
System Info
-------------
Event Time              :$introspector.getDisplayValue($event,"endTime")
Source HostName :$introspector.getDisplayValue($event,"sourceHostName")
Destination HostName    :$introspector.getDisplayValue($event,"destinationHostName")
Database Name           :$introspector.getDisplayValue($event,"deviceCustomString1")

-------------
User Info
-------------
Source User Name        :$introspector.getDisplayValue($event,"sourceUserName")
Destination User Name   :$introspector.getDisplayValue($event,"destinationUserName")

Template: /opt/arcsight/manager/config/notification/test/ex1.vm 


=================================================
ex2.vm
Name: $introspector.getDisplayValue($event,"name")
----
End Time                      :$introspector.getDisplayValue($event,"endTime")
Device Severity               :$introspector.getDisplayValue($event,"deviceSeverity")
Device HostName               :$introspector.getDisplayValue($event,"deviceHostName")
Device Process                :$introspector.getDisplayValue($event,"deviceProcessName")
Source User ID                :$introspector.getDisplayValue($event,"sourceUserId")
Destination User Name         :$introspector.getDisplayValue($event,"destinationUserName")
Destination Address           :$introspector.getDisplayValue($event,"destinationAddress")
Destination Host              :$introspector.getDisplayValue($event,"destinationHostName")
Destination Zone              :$introspector.getDisplayValue($event,"destinationZoneResource")
----
EventID 					            :$introspector.getDisplayValue($event,"externalId")

Template: /opt/arcsight/manager/config/notification/test/ex2.vm 

=================================================
ex3.vm
Name:                           $introspector.getDisplayValue($event,"name")
End Time:                       $introspector.getDisplayValue($event,"endTime")
Source User Name:               $introspector.getDisplayValue($event,"sourceUserName")
Destination User Name:          $introspector.getDisplayValue($event,"destinationUserName")
Source Address:                 $introspector.getDisplayValue($event,"sourceAddress")
Source Host:                    $introspector.getDisplayValue($event,"sourceHostName")
Destination Address:            $introspector.getDisplayValue($event,"destinationAddress")
Destination Host:               $introspector.getDisplayValue($event,"destinationHostName")
----
EventID: $introspector.getDisplayValue($event,"externalId")

Template: /opt/arcsight/manager/config/notification/test/ex3.vm 

=============================================
fail.vm
THIS WAS A FAILURE.
Rule: $introspector.getDisplayValue($event, "name")

Template: /opt/arcsight/manager/config/notification/test/fail.vm 
